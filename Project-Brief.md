<b><h1>Introduction to MSc Cybersecurity Project</h1></b>  
<br/>This project was undertaken as part of the MSc Cybersecurity course at the University of Roehampton, and it outlines a digital forensics investigation into Android APK files, a key area within cybersecurity. The study focuses on comparing APK files obtained from the official Google Play Store with those from alternative sources, such as APKPure. The motivation for this research stems from the widespread assumption among users that APKs from unofficial sites are identical to those from the Play Store, despite potential security risks.

The central problem addressed is the concerning security differences between APK files from official and unofficial sources, particularly for Android mobile application users. Downloading APKs from sites like APKPure can lead to issues such as installation restrictions, corrupted files, incompatibility, conflicts with existing apps, and prevention by security software. Research suggests that APKPure files can be malicious, as demonstrated by exploits discovered in the year 2021 of trojan infection, highlighting the lack of robust security protocols compared to Google Play Store. Key differences include Google Play's rigorous review process ensuring app safety, automatic updates for Play Store apps versus manual updates for APKPure downloads, and the legal implications of obtaining apps from unofficial sources.

The project's aim is to conduct a mobile forensic analysis to identify differences between identical app versions from the Google Play Store and APKPure. This investigation seeks to determine if discrepancies are intentional or unintentional modifications, assess the trustworthiness of APKPure downloads, and ultimately help users decide whether to exclusively rely on the Google Play Store for APKs.

To achieve this, the project outlines several objectives. These include researching Android, APK files, and host sites to compare APKPure files with Google Play Store versions, checking for malware, data leaks, or unauthorized actions (tampering).

<b><h1>Originally Proposed Implementation</h1></b>  
  
Extensive research has been conducted on digital forensics processes, practices, techniques, and tools, with Android Studio, ADB, MobSF, JADX, and Autopsy identified as key tools for the investigation. The implementations of all associated applications were planned to be installed within a virtual environment.

The project's design involves an artifact architecture utilizing JADX for decompilation and static analysis (SAST) to identify permissions, code patterns, and API calls. Dynamic analysis (DAST) will be performed using MobSF to examine app behaviours. A SQLite database will store results, including hashes, permissions, and logs, capturing user activity data for inspection in Autopsy. This database will assess discrepancies in permission abuse, data exfiltration, and tampering issues.

The investigation will analyse ten applications, five identical pairs from both Google Play Store and APKPure, encompassing social media, gaming, and financial apps. Data will be generated on Android Virtual Devices (AVDs), extracted, and forensically analysed in Autopsy. MobSF will be used as a reporting engine due to its capabilities in mobile application security analysis, malware detection, and automated reporting. Android Studio will create two AVDs running Android 14, with Android Debug Bridge (ADB) used for data extraction. The project plans to configure the virtual environment and commence data generation and analysis, aiming to conclude findings by the end of mid-August 2025 before proceeding to report writing and final submission.

The initially proposed implementation encountered some technical issues which was consuming project execution time. The original implementation involved the installation of all required applications within a Virtual Machine environment – which was successfully achieved; however, issues were discovered when it came to running the AVDs (Android Virtual Devices) on the VM environment due to poor processing speed. Within the VM environment a user activity SQLite database was successfully curated which was meant to capture the user interactions with the app to monitor the app behaviours. The file with detailed description of the VM configurations are located within the Project File, titled: VM Setup Documentation was created. A Python script was also fully created which was meant to automatically process all operations within the database (this script is provided within the “Project Files” – titled: main_project.py). The decision was then made to implement the entire project on a local machine.

<h1>Actual Implementation</h1>  
<br/>The implementation of this project required applications such Android Studio, Android Debug Bridge (ADB), JADX, and MobSF. The implementation steps taken are located on this GitHub repo titled: “Implementation Guide”. After installation of the required application for the project, the Android apps required for the project were chosen and some apps were also apps initially chosen were changed. The apps finally used on the project are: TikTok, Subway Surfers, Subway Princess Runner and Twitter.  

<br/> <h1>Android Virtual Devices (AVDs)</h1>
The Android Virtual Devices (AVDs) were created in Android Studio. Two different AVDs were created and configured – one each for Google Play Store APKs (Pixel 8 Pro API 35 - GOOGLE AVD) and APKPure store APKs (Nexus 6 API 35 - APKPURE AVD). A screenshot of the AVDs can be found under the “Project Files”, within the files titled: Pixel 8 Pro API 35 - GOOGLE AVD) and Nexus 6 API 35 - APKPURE AVD.  
<br/>Before downloading the chosen apps on the AVDs they were initially downloaded onto the local machine used for the project an anti-malware software was used to check them for malwares before installing the apps on the AVD within Android Studio environment – this was done to prevent installation of harmful files onto the local machine.  

<h1>Android Debug Bridge (ADB) & JADX</h1>  
ADB devices command was used on windows command prompt to list the AVDs for the project - the AVDs were required to be running for ADB to list them. The screenshot that evidences these actions can be found within the Project Files on this GitHub repository, titled “AVDs on Emulator”. Each AVD were further listed individually in command prompt within the Project Files with the titles: “Listing Google AVD” and “Listing APKPure AVD”.  
<br/>After generating some user activities on the AVDs, the app interaction contents were transferred to JADX via ADB pull commands. APK files for each app on each AVD were extracted to JADX for static analysis, assessing them for permissions, data leaks and tampering. Folders were created on the machine being used for the project, creating individual files for each AVD’s APK files using the names of the emulators and then the names of each app. For example, within emulator 5554_GoogleAVD folder resides the APK files for Google Play Store’s APK files pulled from the AVD – then within emulator 5554_GoogleAVD folder resides e.g. SubwayPrincess_5554, SubwaySurfers_5554 and so on. These subfolders are the locations the APK files extracted from the AVDs are stored which were then used in the upload to JADX for static analysis.  
<br/>The screenshot which evidence the ADB pull of the APKs for each app for the AVDs can be located within the Project Files on the GitHub repo, titled:  

- ADB pull for twitter APK for Google AVD
- ADB pull for twitter APK for APKPure AVD
- ADB pull for TikTok APK for Google AVD
- ADB pull for Subway Surfers APK for Google AVD
- ADB pull for Subway Surfers APK for APKPure AVD
- ADB pull for Subway Santa Princess Runner APK for Google AVD
- ADB pull for Subway Santa Princess Runner APK for APKPure AVD

ADB pull for TikTok APK for APKPure AVD failed to pull data and the TikTok APKs were unable to be analysed and compared due to lack of time to investigate and resolve the issues with pulling this data._  
<br/>_On JADX six separate projects were created to enable distinctions between the files for each AVD and the project files are saved within the Project Files repo, for example SubwayPrincess_5554.apk.jadx_  
<br/>_The APK Signatures for each JADX project were extracted, saved as .txt files uploaded to VirusTotal and then analysed and compared, checking for any evidence of tampering in the APKPure’s APK signatures compared with Google Play Store’s APK signatures. The signatures are saved within the Project Files using the names of the APK and AVD, for example SubwayPrincess_Google_APK_Signature.  
The AndroidManifest.xml file for each JADX project were extracted and manually analysed checking for data leaks and unusual/elevated permissions and the files were saved within the Project Files such as SubwayPrincess_5554_Google_AndroidManifest – for example, the AndroidManifest file belonging the Subway Princess Runner APK for the Google Play Store AVD.

<br/>JADX was configured to 25GB memory space for it handle the APKs files for both AVDs, this configuration was made within JADX’s lib file located where the JADX executable file was stored using the code: java -Xms512m -Xmx25g -jar jadx-1.5.1-all.jar.

Post static analysis using JADX, the implementation phase then moved onto using MobSF for dynamic analysis of the APKs. The AVDs were ensured to be running while MobSF was fired up and used to conduct a dynamic analysis of the APKs of the AVDs – but first, MobSF was configured via a shell environment variable assignment to communicate with the AVDs using the command: set MOBSF_ANALYZER_INDETIFIER=emulator-5554 (for Google AVD) and set MOBSF_ANALYZER_INDETIFIER=emulator-5556 (for APKPure AVD). Although MobSF was configured accurately to detect the running AVDs so that the dynamic analysis could be conducted – MobSF failed to run a dynamic scan as it was unable to detect the running AVDs and there wasn’t enough time left on the project to troubleshoot although it was attempted to find a resolution. Rather, the MobSF static scan results were used to conduct the OWASP Benchmark assessments of vulnerabilities related to malware detections.  
<br/><h1>Project Outcomes</h1>  
<br/>The investigation compared APKs from Google Play Store and APKPure to detect tampering and assess security such as malware detection and unusual/elevated file permissions. Initial SHA256 hash comparisons showed mismatches due to Google re-signing apps and serving optimized APKs. However, digital signature comparisons using JADX and VirusTotal revealed identical developer signatures for corresponding APKs from both stores, indicating no malicious tampering.

AndroidManifest file analysis showed similar permissions for both sources, with minor differences related to distribution metadata, but APKPure Twitter APK showed slightly more potential data exposures. MobSF static scans on "Subway Santa Princess Runner" and "Subway Surfers" found low-security scores and trackers in both versions. Neither scan explicitly identified malware.

OWASP assessments, based on MobSF scans, revealed distinct vulnerabilities. Google's "Subway Santa Princess Runner" had "Insufficient Cryptography". APKPure's version showed "Incorrect Default Permissions" and "Weaknesses in Mobile Applications," potentially leading to data leaks. Both versions of "Subway Surfers" had "dangerous" notification permissions and insecure clear text traffic configurations.

The findings were somewhat inconclusive, as both sources had weaknesses. However, APKPure versions generally exhibited a broader range of high-severity vulnerabilities related to insecure data storage and improper platform usage, suggesting a potentially higher risk. It is therefore advised that users trust Google Play Store more.

<h1>Lessons Learn with Final Thoughts</h1>

The project aimed to conduct a mobile forensic analysis of Android APK files from Google Play Store and APKPure to identify security differences. Initial plans for dynamic analysis using MobSF on a virtual environment faced technical issues, specifically poor processing speed with AVDs on the VM. This led to a shift in implementation to a local machine. Despite correctly configuring MobSF to detect running AVDs, dynamic analysis failed, and project time constraints prevented troubleshooting to resolve the issue. Static analysis with JADX successfully extracted APK signatures and AndroidManifest files, allowing for comparisons. While SHA256 hashes differed, digital signatures were identical, suggesting no malicious tampering. AndroidManifest analysis showed minor permission differences, with APKPure Twitter showing slightly more potential data exposures. MobSF static scans revealed low-security scores and trackers in both versions of some apps, but no explicit malware. OWASP assessments highlighted vulnerabilities in both, but APKPure versions generally showed a broader range of high-severity issues. The project concluded that users should trust Google Play Store more.
